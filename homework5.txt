COP4521 Homework 5

Name: Madeline Boss              FSU login: mab22bb


1) (20 points). A company wants to maintain the commissions for each employee
when the employee sells a product. An employee has two attributes,
employee ID (Eid) and name (Name). A product has two attributes,
product ID (Pid) and maker (Maker). Draw the ER diagram to model the data
for this task.



2) (20 points) Convert the ER diagram in question 1) to equivalent
relations.

Relation = (a1, b1, c1, ..., ck)


Write SQL queries that achieve the following: 

3) (10 points) From relation Sells(bar, beer, price),
find the bars that sell 'Bud Lite' for no more than $3.00.


SELECT bar
FROM Sells
WHERE beer = 'Bud Lite' AND price <= 3.00;






4) (10 points) Using relations Likes(drinker, beer) and
Sells(bar, beer, price), find the bars that sell at least a beer that
Sally likes, the beers (that Sally likes), and the prices. 

SELECT Sells.bar, Likes.beer, Sells.price
FROM Likes, Sells
WHERE drinker = 'Sally' AND Likes.beer = Sells.beer;






5) (10 points) Using relations students(Sid, SSN, LName, FName, Phone, GPA)
and takes(Sid, course), find the student id (Sid), and first names (FName)
and last names (LName) of students who take COP4521 and COP4610.

SELECT students.SID, students.Fname, students.LName
FROM  students, takes
JOIN takes t1 ON students.SID = t1.SID AND t1.course = 'COP4521'
JOIN takes t2 ON students.SID = t2.SID AND t2.course = 'COP4610';








6) (10 points) Using relations Sells(bar, beer, price),
Frequents(drinker, bar), and Likes(drinker, beer), find the average
price of beers that Sally likes at the bars she frequents.


SELECT AVG(price)
FROM Sells, Frequents, Likes
WHERE drinker = 'Sally' 
    AND Likes.drinker = 'Sally'
    AND Sells.bar = Frequents.bar
    AND Sells.beer = Likes.beer;







7) (20 points) Using Frequents(Drinker, bar), insert into a new
relation Buddies(name) all of Sally and Robert's potential drinking
buddies who frequent at least one bar that both Sally and Robert
frequent.

INSERT INTO Buddies(name)
SELECT DISTINCE drinker
FROM Frequents
WHERE drinker NOT IN ('Sally', 'Robert')
    AND bar IN(
        SELECT bar
        FROM Frequents
        WHERE drinker = 'Sally'
        INTERSECT
        SELECT bar
        FROM Frequents
        WHERE drinker = 'Robert'
    );

